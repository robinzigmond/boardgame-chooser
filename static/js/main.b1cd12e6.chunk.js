(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{172:function(e,t,a){e.exports=a(398)},391:function(e,t,a){},395:function(e,t,a){},398:function(e,t,a){"use strict";a.r(t);a(173),a(188);var n=a(0),r=a.n(n),s=a(170),i=a.n(s),l=(a(391),a(171)),o=a(57),c=a(27),u=a.n(c),h=a(51),m=a(11),p=a(12),d=a(15),g=a(13),f=a(14),b=a(2),v=(a(395),function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(g.a)(t).call(this,e))).toggle=a.toggle.bind(Object(b.a)(Object(b.a)(a))),a.state={open:!1},a}return Object(f.a)(t,e),Object(p.a)(t,[{key:"toggle",value:function(){this.setState(function(e){return{open:!e.open}})}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{id:"info",onClick:this.toggle},"What is this?"),this.state.open?r.a.createElement("div",{className:"site-info"},r.a.createElement("p",null,"You know how it is - it's game night, and you're sick of the traditional first game of the evening: the \"what game are we going to play?\" game."),r.a.createElement("p",null,"This site aims to speed up the process. Provided all games you have available to you are stored in one or more of your players' collections on ",r.a.createElement("a",{href:"https://boardgamegeek.com/",target:"_blank",rel:"noopener noreferrer"},"BoardGameGeek"),", you can import those collections just by entering the BGG username(s). Then all you need to do is specify how many players you have, and how long you want the game to take, and the site will show you exactly which games you have available that meet those needs."),r.a.createElement("p",null,"You'll probably still argue about what to play - but at least you'll be able to see all the options at a glance. There are also easy-to-use ways to reorder the list of games, and to filter them by various categories supplied by BGG - I hope these features may prove useful."),r.a.createElement("p",null,"Note that all data is simply that provided by BoardGameGeek - you can't expect me to manually provide data for tens of thousands of games and know how long a playtime they might all have! So please don't complain to me that 7-player ",r.a.createElement("a",{href:"https://boardgamegeek.com/boardgame/102794/caverna-cave-farmers",target:"_blank",rel:"noopener noreferrer"},"Caverna")," can't possibly be played in an hour or less, or that it only suggests ",r.a.createElement("a",{href:"https://boardgamegeek.com/boardgame/98778/hanabi",target:"_blank",rel:"noopener noreferrer"},"Hanabi")," if you put exactly 25 minutes in. Complain to BGG, and see if it does you any good (unlikely) - it's nothing I can do anything about. (Although I certainly sympathise!)"),r.a.createElement("p",null,"Made by Robin Zigmond, developer and boardgamer, please feel free to check out my profiles on ",r.a.createElement("a",{href:"https://boardgamegeek.com/user/robinz",target:"_blank",rel:"noopener noreferrer"},"BGG")," and ",r.a.createElement("a",{href:"https://github.com/robinzigmond",target:"_blank",rel:"noopener noreferrer"},"Github"),". If you find this useful, please spread the word, and don't be afraid to make suggestions (eg by private message on BGG) as to how to improve the site."),r.a.createElement("button",{id:"info-close",onClick:this.toggle},"Close")):null)}}]),t}(n.Component)),y=function(e){function t(){return Object(m.a)(this,t),Object(d.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e;return e=this.props.duplicate?"You've already got that user's collection imported!":"Failed to load - please check the username and try again!",r.a.createElement("div",{className:"failure"},r.a.createElement("p",null,e),r.a.createElement("div",{className:"close-box",onClick:this.props.close},"X"))}}]),t}(n.Component),k=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(g.a)(t).call(this,e))).state={loading:!1},a}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e;return this.state.data&&!this.state.loading&&(e=this.state.data.length?"Collection successfully loaded!":"Invalid username entered"),r.a.createElement("form",null,r.a.createElement("div",{className:"form-section"},r.a.createElement("label",{htmlFor:"bgg-username"},"Enter a BGG username to import their collection:"),r.a.createElement("input",{type:"text",name:"bgg-username",onChange:this.props.handleChange,value:this.state.username}),r.a.createElement("button",{type:"submit",onClick:this.props.handleSubmit},"Go!")),e?r.a.createElement("p",null,e):null)}}]),t}(n.Component),O=function(e){function t(){return Object(m.a)(this,t),Object(d.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{type:"checkbox",value:this.props.value,onChange:this.props.handleChange,id:this.props.id,checked:this.props.checked}),r.a.createElement("div",{className:"custom-checkbox"},this.props.checked?"\u2713":""))}}]),t}(n.Component),j=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(g.a)(t).call(this,e))).handleWantImport=a.handleWantImport.bind(Object(b.a)(Object(b.a)(a))),a.toggleRemoval=a.toggleRemoval.bind(Object(b.a)(Object(b.a)(a))),a.state={toDelete:[],showForm:e.showForm},a}return Object(f.a)(t,e),Object(p.a)(t,[{key:"handleWantImport",value:function(){this.setState({showForm:!0})}},{key:"toggleRemoval",value:function(e){var t=this.state.toDelete.findIndex(function(t){return t===e});this.setState(function(a){var n=a.toDelete;return-1===t?n.push(e):n.splice(t,1),{toDelete:n}})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{id:"collection-info"},this.props.data.length?r.a.createElement("div",{className:"form-section"},r.a.createElement("p",null,"Collections loaded for:"),r.a.createElement("ul",null,this.props.data.map(function(t,a){return r.a.createElement("li",{key:a},r.a.createElement(O,{handleChange:function(){return e.toggleRemoval(t)},checked:e.state.toDelete.includes(t)}),r.a.createElement("span",null,t))})),this.state.toDelete.length?r.a.createElement("button",{onClick:function(){return e.props.removeUsers(e.state.toDelete)}},"Remove selected collections"):null):r.a.createElement("p",null,"No collection data loaded yet"),this.state.showForm?r.a.createElement(k,{handleChange:this.props.handleUserNameChange,handleSubmit:this.props.handleImportSubmit}):r.a.createElement("div",{className:"form-section"},r.a.createElement("button",{onClick:this.handleWantImport},"Click to add a new collection")))}}]),t}(n.Component),E=function(e){function t(){return Object(m.a)(this,t),Object(d.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e="loader meeple-".concat(this.props.colour);return r.a.createElement("div",{className:"loader-box"},r.a.createElement("div",{className:e}),r.a.createElement("p",null,"Loading collection..."))}}]),t}(n.Component),C=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(g.a)(t).call(this,e))).selectOption=a.selectOption.bind(Object(b.a)(Object(b.a)(a))),a.state={value:a.props.value,open:!1},a}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props.options.length,a=e.options.length;(1===t&&a>1||t>1&&1===a)&&this.setState({open:!1})}},{key:"selectOption",value:function(e){var t=this,a=e.target.dataset.value;this.setState({value:a,open:!1},function(){return t.props.updateParent(a)})}},{key:"render",value:function(){var e=this,t="custom-select";return this.state.open&&(t+=" open"),r.a.createElement("div",{className:t},r.a.createElement("div",{className:"select-main",onClick:function(){return e.setState(function(t){var a=t.open;return{open:e.props.options.length>1&&!a}})}},r.a.createElement("p",{className:"select-text"},this.props.options.find(function(t){return String(t.value)===String(e.state.value)}).text),this.props.options.length>1?r.a.createElement("div",{className:"select-arrow"},"\u25bc"):null),r.a.createElement("div",{className:"select-body"},this.props.options.map(function(t){var a=t.value,n=t.text,s="select-option";return String(a)===String(e.state.value)&&(s+=" selected"),r.a.createElement("div",{key:a,className:s,"data-value":a,onClick:e.selectOption},n)})))}}]),t}(n.Component),w=function(e){function t(){return Object(m.a)(this,t),Object(d.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"pagination-buttons"},r.a.createElement("button",{onClick:this.props.first,disabled:this.props.onFirst},"|<"),r.a.createElement("button",{onClick:this.props.prev,disabled:this.props.onFirst},"<"),r.a.createElement("button",{onClick:this.props.next,disabled:this.props.onLast},">"),r.a.createElement("button",{onClick:this.props.last,disabled:this.props.onLast},">|"))}}]),t}(n.Component),x=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(g.a)(t).call(this,e))).updateFilters=a.updateFilters.bind(Object(b.a)(Object(b.a)(a))),a.getGames=a.getGames.bind(Object(b.a)(Object(b.a)(a))),a.state={itemNames:[]},a.singularForms={categories:"category",families:"family",mechanics:"mechanic"},a}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.getGames(this.props)}},{key:"componentDidUpdate",value:function(e){e.filterType!==this.props.filterType&&this.getGames(this.props)}},{key:"getGames",value:function(e){this.setState(function(t,a){var n=new Set;for(var r in e.games.forEach(function(e){e[a.filterType].forEach(function(e){n.add(e)})}),e.currentFlags)e.currentFlags[r]&&n.add(r);return{itemNames:n}})}},{key:"updateFilters",value:function(e,t,a){e.target.checked?this.props.updateFilters(t,this.props.filterType,a):this.props.updateFilters(t,this.props.filterType)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"filter-list"},r.a.createElement("div",{className:"wrapper"},r.a.createElement("div",{className:"close-box",onClick:this.props.close},"X"),r.a.createElement("h3",null,"Filter games by ",this.singularForms[this.props.filterType]),Array.from(this.state.itemNames).sort().map(function(t,a){return r.a.createElement("div",{key:a,className:"single-filter"},r.a.createElement("span",{className:"filter-name"},t),r.a.createElement("div",{className:"filter-checks"},r.a.createElement("label",{htmlFor:"".concat(t,"Required")},"Require"),r.a.createElement("input",{type:"checkbox",name:"".concat(t,"Required"),onChange:function(a){return e.updateFilters(a,t,1)},checked:1===e.props.currentFlags[t]}),r.a.createElement("label",{htmlFor:"".concat(t,"Banned")},"Remove"),r.a.createElement("input",{type:"checkbox",name:"".concat(t,"Banned"),onChange:function(a){return e.updateFilters(a,t,-1)},checked:-1===e.props.currentFlags[t]})))})))}}]),t}(n.Component),S=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(g.a)(t).call(this,e))).toolTip=r.a.createRef(),a}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.toolTip.current.style.right=this.props.xPos+"px",this.toolTip.current.style.bottom=this.props.yPos+"px"}},{key:"render",value:function(){var e=this.props.info,t=e.required,a=e.banned;return r.a.createElement("div",{id:"tooltip",ref:this.toolTip},r.a.createElement("div",{id:"tooltip-body"},r.a.createElement("p",null,t.length?r.a.createElement("span",null,r.a.createElement("strong",null,"Required: "),t.join(", ")):null,t.length&&a.length?" ":null,a.length?r.a.createElement("span",null,r.a.createElement("strong",null,"Removed: "),a.join(", ")):null)),r.a.createElement("div",{id:"tooltip-arrow"}))}}]),t}(n.Component),F=function(e){function t(e){var a;Object(m.a)(this,t),(a=Object(d.a)(this,Object(g.a)(t).call(this,e))).gamesPerPage=20;var n=Math.ceil(a.props.games.length/a.gamesPerPage);return a.first=a.first.bind(Object(b.a)(Object(b.a)(a))),a.next=a.next.bind(Object(b.a)(Object(b.a)(a))),a.last=a.last.bind(Object(b.a)(Object(b.a)(a))),a.prev=a.prev.bind(Object(b.a)(Object(b.a)(a))),a.handleMouseEnter=a.handleMouseEnter.bind(Object(b.a)(Object(b.a)(a))),a.handleMouseLeave=a.handleMouseLeave.bind(Object(b.a)(Object(b.a)(a))),a.container=r.a.createRef(),a.state={page:1,lastPage:n,tooltip:!1},a}return Object(f.a)(t,e),Object(p.a)(t,[{key:"first",value:function(){this.setState({page:1})}},{key:"next",value:function(){this.setState(function(e){return{page:Math.min(e.page+1,e.lastPage)}})}},{key:"last",value:function(){this.setState(function(e){return{page:e.lastPage}})}},{key:"prev",value:function(){this.setState(function(e){return{page:Math.max(1,e.page-1)}})}},{key:"convertRating",value:function(e,t,a){return null==e?a||"not rated":(+e).toFixed(t)}},{key:"handleMouseEnter",value:function(e,t){var a=this.container.current.getBoundingClientRect(),n=this.props.flags[t],r=Object.keys(n),s=r.filter(function(e){return 1===n[e]}),i=r.filter(function(e){return-1===n[e]});this.setState({tooltip:!0,tooltipInfo:{required:s,banned:i},mouseX:a.width-e.pageX+a.left+window.scrollX-20,mouseY:a.height-e.pageY+a.top+window.scrollY+10})}},{key:"handleMouseLeave",value:function(){this.setState({tooltip:!1,tooltipInfo:{},mouseX:null,mouseY:null})}},{key:"render",value:function(){var e=this;if(this.props.games.length){var t;switch(this.props.sorting){case"alphabetical":break;case"yearpublished":t=function(t){return e.convertRating(t.yearpublished,0,"unknown")};break;case"weight":t=function(t){return e.convertRating(t.stats.averageweight,2,"not enough data")};break;case"bggRank":t=function(t){return e.convertRating(t.stats.ranks[0].value,0,"not ranked")};break;default:var a=this.props.sorting.slice(6);t=function(t){return e.convertRating(t.ratings[a],1,"not rated")}}return r.a.createElement("div",{className:"game-list",ref:this.container},this.props.games.length?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"filters"},r.a.createElement("p",null,"Filter results by:"),r.a.createElement("ul",null,this.props.filters.map(function(t,a){var n=e.props.flags[t],s=n&&Object.keys(n).some(function(e){return 0!==n[e]});return r.a.createElement("li",{key:a,className:"filter-option"+(s?" filter-used":""),onClick:function(){return e.props.filterDisplay(t)}},r.a.createElement("span",{onMouseEnter:s?function(a){return e.handleMouseEnter(a,t)}:null,onMouseLeave:s?e.handleMouseLeave:null},t))}))),r.a.createElement("div",null,r.a.createElement("h3",null,"Suitable Games",this.state.lastPage>1?" - page ".concat(this.state.page," of ").concat(this.state.lastPage):null),this.state.lastPage>1?r.a.createElement(w,{first:this.first,next:this.next,prev:this.prev,last:this.last,onFirst:1===this.state.page,onLast:this.state.page===this.state.lastPage}):null,r.a.createElement("div",{className:"gamelist"},this.props.games.slice((this.state.page-1)*this.gamesPerPage,this.state.page*this.gamesPerPage).map(function(e){return r.a.createElement("div",{className:"game-info",key:e.id},r.a.createElement("a",{href:"https://boardgamegeek.com/boardgame/".concat(e.id),target:"_blank",rel:"noopener noreferrer"},r.a.createElement("img",{alt:"".concat(e.name),src:e.thumbnail}),r.a.createElement("h4",null,e.name,t?" (".concat(t(e),")"):null)))})),this.state.lastPage>1?r.a.createElement(w,{first:this.first,next:this.next,prev:this.prev,last:this.last,onFirst:1===this.state.page,onLast:this.state.page===this.state.lastPage}):null)):r.a.createElement("p",null,"Unfortunately, none of your games fit the filters you've selected!"),this.props.showFilters?r.a.createElement(x,{games:this.props.games,updateFilters:this.props.updateFilters,currentFlags:this.props.flags[this.props.showFilters],close:function(){return e.props.filterDisplay()},key:this.props.games.map(function(e){return e.id}).join(","),filterType:this.props.showFilters}):null,this.state.tooltip?r.a.createElement(S,{info:this.state.tooltipInfo,xPos:this.state.mouseX,yPos:this.state.mouseY}):null)}return r.a.createElement("p",null,"Unfortunately, none of your games fit your criteria!")}}]),t}(n.Component),R=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(g.a)(t).call(this,e))).timePresets=[{mins:30,label:"Half an Hour"},{mins:60,label:"1 Hour"},{mins:120,label:"2 Hours"},{mins:180,label:"3 Hours"}],a.filters=["categories","families","mechanics"],a.initialiseFlags=a.initialiseFlags.bind(Object(b.a)(Object(b.a)(a))),a.updateFilters=a.updateFilters.bind(Object(b.a)(Object(b.a)(a))),a.doFilters=a.doFilters.bind(Object(b.a)(Object(b.a)(a))),a.filterDisplay=a.filterDisplay.bind(Object(b.a)(Object(b.a)(a))),a.handlePlayerCountChange=a.handlePlayerCountChange.bind(Object(b.a)(Object(b.a)(a))),a.handleAvailableTimeChange=a.handleAvailableTimeChange.bind(Object(b.a)(Object(b.a)(a))),a.handleTimePresetChange=a.handleTimePresetChange.bind(Object(b.a)(Object(b.a)(a))),a.handleMinWeightChange=a.handleMinWeightChange.bind(Object(b.a)(Object(b.a)(a))),a.handleMaxWeightChange=a.handleMaxWeightChange.bind(Object(b.a)(Object(b.a)(a))),a.handleOrderChange=a.handleOrderChange.bind(Object(b.a)(Object(b.a)(a))),a.handleSubmit=a.handleSubmit.bind(Object(b.a)(Object(b.a)(a))),a.state={playerCount:4,useRecommended:!1,availableTime:30,gameOrder:"alphabetical",showWeightFilters:!1,minWeight:1,maxWeight:5,allGames:[],given:!1,filteredGames:[],flags:{},showFilters:!1},a}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.initialiseFlags()}},{key:"componentDidUpdate",value:function(e,t){t.gameOrder===this.state.gameOrder&&t.minWeight===this.state.minWeight&&t.maxWeight===this.state.maxWeight||this.handleSubmit(!1)}},{key:"initialiseFlags",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t={};this.filters.forEach(function(e){t[e]={}}),this.setState({flags:t},e)}},{key:"updateFilters",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.setState(function(n){var r=n.flags;return r[t][e]=a,{flags:r,page:1}},this.doFilters)}},{key:"doFilters",value:function(){var e=this;this.setState(function(t){var a=t.flags,n=Object(o.a)(t.allGames);return e.filters.forEach(function(e){var t=function(t){switch(a[e][t]){case 1:n=n.filter(function(a){return a[e].includes(t)});break;case-1:n=n.filter(function(a){return!a[e].includes(t)})}};for(var r in a[e])t(r)}),{filteredGames:n}})}},{key:"filterDisplay",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.setState({showFilters:e})}},{key:"handlePlayerCountChange",value:function(e){var t=e.target.value;""===t?this.setState({playerCount:t}):+t>0&&this.setState({playerCount:+t})}},{key:"handleAvailableTimeChange",value:function(e){var t=e.target.value;""===t?this.setState({availableTime:t}):+t>=0&&this.setState({availableTime:+t})}},{key:"handleTimePresetChange",value:function(e){e.target.checked?this.setState({availableTime:e.target.value}):this.setState({availableTime:""})}},{key:"handleMinWeightChange",value:function(e){this.setState({minWeight:e})}},{key:"handleMaxWeightChange",value:function(e){this.setState({maxWeight:e})}},{key:"handleOrderChange",value:function(e){this.setState({gameOrder:e})}},{key:"handleSubmit",value:function(){var e=this;function t(e){return e.toLowerCase().replace(/^(((the|a|an)\s+)|[^A-Za-z0-9]+)/,"")}function a(e,t){return function(a,n){return e(a,n)?e(a,n):t(a,n)}}function n(e,a){var n=t(e.name),r=[n,t(a.name)];return r.sort(),1-2*(r[0]===n)}arguments.length>0&&void 0!==arguments[0]&&!arguments[0]?this.state.playerCount&&this.state.availableTime&&this.setState(function(t,r){var s,i=r.data.filter(function(e){return e.minplaytime<=t.availableTime&&e.maxplaytime>=t.availableTime&&e.stats.averageweight>=t.minWeight&&e.stats.averageweight<=t.maxWeight});switch(i=t.useRecommended?i.filter(function(e){if(!e.suggested_numplayers||!e.suggested_numplayers.results)return!1;var a=e.suggested_numplayers.results[t.playerCount];return a&&a.best+a.recommended>a.not_recommended}):i.filter(function(e){return e.minplayers<=t.playerCount&&e.maxplayers>=t.playerCount}),t.gameOrder){case"alphabetical":s=n;break;case"yearpublished":s=a(function(e,t){return(e.yearpublished||1/0)-(t.yearpublished||1/0)},n);break;case"weight":s=a(function(e,t){return(e.stats.averageweight||1/0)-(t.stats.averageweight||1/0)},n);break;case"bggRank":s=a(function(e,t){return(e.stats.ranks[0].value||1/0)-(t.stats.ranks[0].value||1/0)},n);break;default:var l=e.state.gameOrder.slice(6);s=a(function(e,t){return(t.ratings[l]||0)-(e.ratings[l]||0)},n)}return i.sort(s),{given:!0,allGames:i}},this.doFilters):this.initialiseFlags(function(){return e.handleSubmit(!1)})}},{key:"render",value:function(){var e,t=this,a=this.props.users;return(e=a.length>1?a.map(function(e){return{value:"rating".concat(e),text:"".concat(e,"'s rating")}}):[{value:"rating".concat(a[0]),text:"My Rating"}]).unshift({value:"alphabetical",text:"Name (alphabetical)"},{value:"yearpublished",text:"Year published"},{value:"weight",text:"Game weight (complexity)"}),e.push({value:"bggRank",text:"BGG ranking list position"}),r.a.createElement("div",null,r.a.createElement("div",{className:"form-section"},r.a.createElement("div",{className:"input-block"},r.a.createElement("label",{htmlFor:"playerCount"},"Number of Players"),r.a.createElement("input",{type:"number",name:"playerCount",id:"playerCount",value:this.state.playerCount,onChange:this.handlePlayerCountChange})),r.a.createElement("div",{className:"input-block bottom-gap"},r.a.createElement("label",{htmlFor:"useRecommended"},"Only select games which BGG users recommend for this player count?"),r.a.createElement(O,{value:"useRecommended",handleChange:function(){return t.setState(function(e){return{useRecommended:!e.useRecommended}})},id:"useRecommended",checked:this.state.useRecommended})),r.a.createElement("div",{className:"input-block"},r.a.createElement("label",{htmlFor:"availableTime"},"Desired Playing Time (minutes)"),r.a.createElement("input",{type:"number",id:"availableTime",name:"availableTime",value:this.state.availableTime,onChange:this.handleAvailableTimeChange}),r.a.createElement("div",null,"Or select:",this.timePresets.map(function(e){return r.a.createElement("div",{className:"time-checkbox",key:e.mins},r.a.createElement("label",{htmlFor:"timePreset".concat(e.mins)},e.label,":"),r.a.createElement(O,{value:e.mins,handleChange:t.handleTimePresetChange,id:"timePreset".concat(e.mins),checked:+t.state.availableTime===e.mins}))}))),r.a.createElement("div",{className:"input-block standalone"},r.a.createElement("button",{type:"button",onClick:function(){return t.setState(function(e){return{showWeightFilters:!e.showWeightFilters}})}},this.state.showWeightFilters?"Hide weight filters":"Filter by weight (complexity)")),this.state.showWeightFilters?r.a.createElement("div",{className:"input-block mini-select"},r.a.createElement("p",{className:"select-label"},"Minimum game weight:"),r.a.createElement(C,{options:[1,2,3,4,5].filter(function(e){return e<t.state.maxWeight}).map(function(e){return{value:e,text:e}}),value:this.state.minWeight,updateParent:this.handleMinWeightChange}),r.a.createElement("p",{className:"select-label"},"Maximum game weight:"),r.a.createElement(C,{options:[1,2,3,4,5].filter(function(e){return e>t.state.minWeight}).map(function(e){return{value:e,text:e}}),value:this.state.maxWeight,updateParent:this.handleMaxWeightChange})):null,r.a.createElement("div",{className:"input-block"},r.a.createElement("p",{className:"select-label"},"Order results by:"),r.a.createElement(C,{options:e,value:e[0].value,updateParent:this.handleOrderChange})),r.a.createElement("div",{className:"input-block"},r.a.createElement("button",{type:"button",onClick:function(){return t.handleSubmit()}},this.state.given?"Update":"Get"," recommendations!"))),this.state.given?r.a.createElement(F,{games:this.state.filteredGames,key:this.state.filteredGames.map(function(e){return e.id}).join(","),sorting:this.state.gameOrder,numUsers:this.props.users.length,filters:this.filters,flags:this.state.flags,updateFilters:this.updateFilters,showFilters:this.state.showFilters,filterDisplay:this.filterDisplay}):null)}}]),t}(n.Component),N="https://wgtp-backend.herokuapp.com",P=function(e){function t(e){var a;Object(m.a)(this,t),(a=Object(d.a)(this,Object(g.a)(t).call(this,e))).handleUserNameChange=a.handleUserNameChange.bind(Object(b.a)(Object(b.a)(a))),a.clearAndRemove=a.clearAndRemove.bind(Object(b.a)(Object(b.a)(a))),a.checkStatus=a.checkStatus.bind(Object(b.a)(Object(b.a)(a))),a.handleRequest=a.handleRequest.bind(Object(b.a)(Object(b.a)(a))),a.handleImportSubmit=a.handleImportSubmit.bind(Object(b.a)(Object(b.a)(a))),a.setRatings=a.setRatings.bind(Object(b.a)(Object(b.a)(a))),a.getUserData=a.getUserData.bind(Object(b.a)(Object(b.a)(a))),a.closeBox=a.closeBox.bind(Object(b.a)(Object(b.a)(a))),a.removeUsers=a.removeUsers.bind(Object(b.a)(Object(b.a)(a))),a.tries=0,a.intervals={},a.pendingRequests=!1,a.meepleColours=["red","yellow","green","blue"];var n=a.meepleColours[Math.floor(Math.random()*a.meepleColours.length)];return a.state={username:"",data:{games:[],users:[]},failure:!1,showDuplicate:!1,loading:!1,meepleColour:n},a}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentWillUnmount",value:function(){var e=!0,t=!1,a=void 0;try{for(var n,r=this.intervals[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var s=n.value;this.clearAndRemove(s)}}catch(i){t=!0,a=i}finally{try{e||null==r.return||r.return()}finally{if(t)throw a}}}},{key:"handleUserNameChange",value:function(e){this.setState({username:e.target.value})}},{key:"clearAndRemove",value:function(e){clearInterval(this.intervals[e]),delete this.intervals[e]}},{key:"checkStatus",value:function(){var e=Object(h.a)(u.a.mark(function e(t,a){var n,r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.tries++,e.next=3,fetch("".concat(N,"/result/").concat(t));case 3:return n=e.sent,e.next=6,n.json();case 6:(r=e.sent).done?(this.clearAndRemove(t),this.tries=0,a(r.result),this.pendingRequests||Object.keys(this.intervals).length||this.setState({loading:!1})):(r.failed||this.tries>=50)&&(this.clearAndRemove(t),this.tries=0,this.setState({failure:!0,loading:!1}),this.pendingRequests=!1);case 8:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"handleRequest",value:function(){var e=Object(h.a)(u.a.mark(function e(t,a){var n,r,s,i=this;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return(n=e.sent).ok||(this.setState({failure:!0,loading:!1}),this.pendingRequests=!1),e.next=6,n.json();case 6:r=e.sent,s=r.job_id,this.intervals[s]=setInterval(function(){return i.checkStatus(s,a)},5e3);case 9:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"setRatings",value:function(){var e=Object(h.a)(u.a.mark(function e(t,a,n){var r,s,i,c,h,m,p,d;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=Object(o.a)(n),s=!0,i=!1,c=void 0,e.prev=4,h=a[Symbol.iterator]();case 6:if(s=(m=h.next()).done){e.next=14;break}return p=m.value,d=p.map(String).join("-"),e.next=11,this.handleRequest("".concat(N,"/check_ratings/").concat(t,"/").concat(d),function(e){var a=function(a){if(null!==e[a]){var n=r.find(function(e){return e.id===+a});n&&(n.ratings?n.ratings[t]=e[a]:n.ratings[t]=Object(l.a)({},t,e[a]))}};for(var n in e)a(n)});case 11:s=!0,e.next=6;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(4),i=!0,c=e.t0;case 20:e.prev=20,e.prev=21,s||null==h.return||h.return();case 23:if(e.prev=23,!i){e.next=26;break}throw c;case 26:return e.finish(23);case 27:return e.finish(20);case 28:return e.abrupt("return",r);case 29:case"end":return e.stop()}},e,this,[[4,16,20,28],[21,,23,27]])}));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"getUserData",value:function(){var e=Object(h.a)(u.a.mark(function e(){var t=this;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.pendingRequests){e.next=2;break}return e.abrupt("return");case 2:this.handleRequest("".concat(N,"/collection/").concat(this.state.username),function(e){t.setState(function(a){if(e&&e.length){var n=function(e,t){for(var a=[];e.length>0;){for(var n=[];n.length<t&&e.length>0;)n.push(e.shift());a.push(n)}return a};t.pendingRequests=!0;var r={games:Object(o.a)(a.data.games),users:Object(o.a)(a.data.users)};r.users.push(a.username);var s=e.map(function(e){return e.id}),i=r.games,l=i.map(function(e){return e.id}),c=e.filter(function(e){return!l.includes(e.id)}),m=n(s,200),p=n(l,200);Object(h.a)(u.a.mark(function e(){var a,n,s,l,o,h;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=!0,n=!1,s=void 0,e.prev=3,l=r.users[Symbol.iterator]();case 5:if(a=(o=l.next()).done){e.next=13;break}return h=o.value,e.next=9,t.setRatings(h,m,c);case 9:c=e.sent;case 10:a=!0,e.next=5;break;case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(3),n=!0,s=e.t0;case 19:e.prev=19,e.prev=20,a||null==l.return||l.return();case 22:if(e.prev=22,!n){e.next=25;break}throw s;case 25:return e.finish(22);case 26:return e.finish(19);case 27:return e.next=29,t.setRatings(t.state.username,p,i);case 29:i=e.sent,t.pendingRequests=!1;case 31:case"end":return e.stop()}},e,this,[[3,15,19,27],[20,,22,26]])}))();var d=i.concat(c);return d.forEach(function(a){a.users||(a.users=[]),e.map(function(e){return e.id}).includes(a.id)&&a.users.push(t.state.username),a.ratings||(a.ratings={})}),{data:{users:r.users,games:d}}}return{failure:!0,loading:!1}})});case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"handleImportSubmit",value:function(){var e=Object(h.a)(u.a.mark(function e(t){var a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),this.state.data.users.includes(this.state.username)?this.setState({showDuplicate:!0}):(a=this.meepleColours[Math.floor(Math.random()*this.meepleColours.length)],this.setState({loading:!0,failure:!1,meepleColour:a},this.getUserData));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"closeBox",value:function(){this.state.showDuplicate?this.setState({failure:!1,showDuplicate:!1,username:""}):this.setState({failure:!1,showDuplicate:!1})}},{key:"removeUsers",value:function(e){this.setState(function(t){var a=t.data,n=a.users,r=a.games;e.forEach(function(e){if(n.includes(e)){var t=n.findIndex(function(t){return t===e});n.splice(t,1)}});var s=[];return r.forEach(function(t){t.users=t.users.filter(function(t){return!e.includes(t)});var a=!0,n=!1,r=void 0;try{for(var i,l=e[Symbol.iterator]();!(a=(i=l.next()).done);a=!0){var o=i.value;Object.keys(t.users).includes(o)&&delete t.users[o]}}catch(c){n=!0,r=c}finally{try{a||null==l.return||l.return()}finally{if(n)throw r}}t.users.length||s.push(t.id)}),r=r.filter(function(e){return!s.includes(e.id)}),{data:{users:n,games:r}}})}},{key:"render",value:function(){var e=this.state.data.games.filter(function(e){return e.users.length});return r.a.createElement("div",{className:"App"},r.a.createElement("h1",null,"Find a boardgame to play!"),r.a.createElement("h4",null,"Import your BGG collection, give your preferences and get instant recommendations"),r.a.createElement(v,null),this.state.failure?r.a.createElement(y,{close:this.closeBox}):null,this.state.showDuplicate?r.a.createElement(y,{close:this.closeBox,duplicate:!0}):null,r.a.createElement(j,{data:this.state.data.users,showForm:!this.state.data.users.length,handleUserNameChange:this.handleUserNameChange,handleImportSubmit:this.handleImportSubmit,removeUsers:this.removeUsers,key:this.state.data.users}),this.state.loading?r.a.createElement(E,{colour:this.state.meepleColour}):null,!this.state.loading&&this.state.data.games.length?r.a.createElement(R,{key:e.length,data:e,users:this.state.data.users}):null)}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(P,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[172,2,1]]]);
//# sourceMappingURL=main.b1cd12e6.chunk.js.map